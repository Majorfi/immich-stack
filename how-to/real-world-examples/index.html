
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Automatically groups similar photos into stacks within the Immich photo management system">
      
      
        <meta name="author" content="MajorFi">
      
      
      
        <link rel="prev" href="../">
      
      
        <link rel="next" href="../debug-parent-selection/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Real-World Examples - Immich Stack</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#real-world-examples" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Immich Stack" class="md-header__button md-logo" aria-label="Immich Stack" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Immich Stack
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Real-World Examples
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/majorfi/immich-stack" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    majorfi/immich-stack
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../getting-started/installation/" class="md-tabs__link">
          
  
  
  Getting Started

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../commands/" class="md-tabs__link">
          
  
  
  Commands

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../features/stacking-logic/" class="md-tabs__link">
          
  
  
  Features

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
  How-To

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../integration/docker/" class="md-tabs__link">
          
  
  
  Integration

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../api-reference/environment-variables/" class="md-tabs__link">
          
  
  
  API Reference

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../contributing/development/" class="md-tabs__link">
          
  
  
  Contributing

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Immich Stack" class="md-nav__button md-logo" aria-label="Immich Stack" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Immich Stack
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/majorfi/immich-stack" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    majorfi/immich-stack
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Getting Started
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/quick-start/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quick Start
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Commands
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Commands
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/duplicates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Duplicates
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/fix-trash/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Fix Trash
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Features
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Features
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../features/stacking-logic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Stacking Logic
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../features/multi-user/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Multi-User Support
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../features/custom-criteria/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Custom Criteria
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    How-To
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    How-To
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Real-World Examples
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Real-World Examples
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#defaults-at-a-glance" class="md-nav__link">
    <span class="md-ellipsis">
      
        Defaults at a glance
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quick-verification" class="md-nav__link">
    <span class="md-ellipsis">
      
        Quick verification
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#raw-jpeg-pairing" class="md-nav__link">
    <span class="md-ellipsis">
      
        RAW + JPEG Pairing
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RAW + JPEG Pairing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#canon-nikon-sony-same-filename-different-extension" class="md-nav__link">
    <span class="md-ellipsis">
      
        Canon / Nikon / Sony (same filename, different extension)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fujifilm-raf-jpeg" class="md-nav__link">
    <span class="md-ellipsis">
      
        Fujifilm RAF + JPEG
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#samsung-galaxy-jpg-dng" class="md-nav__link">
    <span class="md-ellipsis">
      
        Samsung Galaxy (JPG + DNG)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#apple-iphone-proraw-heic-dng" class="md-nav__link">
    <span class="md-ellipsis">
      
        Apple iPhone ProRAW (HEIC + DNG)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#google-pixel-photos" class="md-nav__link">
    <span class="md-ellipsis">
      
        Google Pixel Photos
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Google Pixel Photos">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pixel-raw-jpeg-standard" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pixel RAW + JPEG (standard)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pixel-motion-photos" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pixel Motion Photos
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pixel-10-pro-triple-grouping-30x-zoom" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pixel 10 Pro Triple Grouping (30x Zoom)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#google-photos-edited-versions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Google Photos Edited Versions
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rawjpeg-with-lightroom-numeric-edits" class="md-nav__link">
    <span class="md-ellipsis">
      
        RAW+JPEG with Lightroom Numeric Edits
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#photoshop-workflows" class="md-nav__link">
    <span class="md-ellipsis">
      
        Photoshop Workflows
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Photoshop Workflows">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#raw-jpeg-psd-photoshop-project-files" class="md-nav__link">
    <span class="md-ellipsis">
      
        RAW + JPEG + PSD (Photoshop Project Files)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#raw-jpeg-psd-with-final-export" class="md-nav__link">
    <span class="md-ellipsis">
      
        RAW + JPEG + PSD with Final Export
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#photoshop-with-versioned-exports" class="md-nav__link">
    <span class="md-ellipsis">
      
        Photoshop with Versioned Exports
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aperturelightroom-vault-with-photoshop-edits" class="md-nav__link">
    <span class="md-ellipsis">
      
        Aperture/Lightroom Vault with Photoshop Edits
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#burst-photos" class="md-nav__link">
    <span class="md-ellipsis">
      
        Burst Photos
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Burst Photos">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#camera-bursts-with-shared-timestamp" class="md-nav__link">
    <span class="md-ellipsis">
      
        Camera Bursts with Shared Timestamp
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sequential-burst-photos-with-common-prefix" class="md-nav__link">
    <span class="md-ellipsis">
      
        Sequential Burst Photos with Common Prefix
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#limitation-fully-sequential-filenames" class="md-nav__link">
    <span class="md-ellipsis">
      
        Limitation: Fully Sequential Filenames
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parent-selection-control" class="md-nav__link">
    <span class="md-ellipsis">
      
        Parent Selection Control
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Parent Selection Control">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#always-show-processed-files-on-top-lightroom-behavior" class="md-nav__link">
    <span class="md-ellipsis">
      
        Always Show Processed Files on Top (Lightroom Behavior)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#always-show-raw-on-top" class="md-nav__link">
    <span class="md-ellipsis">
      
        Always Show RAW on Top
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefer-edited-files-on-top" class="md-nav__link">
    <span class="md-ellipsis">
      
        Prefer Edited Files on Top
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mixed-camera-setups" class="md-nav__link">
    <span class="md-ellipsis">
      
        Mixed Camera Setups
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Mixed Camera Setups">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#multiple-cameras-with-different-naming" class="md-nav__link">
    <span class="md-ellipsis">
      
        Multiple Cameras with Different Naming
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#docker-compose-full-example" class="md-nav__link">
    <span class="md-ellipsis">
      
        Docker Compose Full Example
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../debug-parent-selection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Debug Parent Selection
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../migrate-criteria/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Migrate Criteria
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../optimize-performance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Optimize Performance
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Integration
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Integration
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integration/docker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Docker
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integration/docker-compose/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Docker Compose
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    API Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/environment-variables/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Environment Variables
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/cli-usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CLI Usage
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/asset-operations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Asset Operations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/stack-operations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Stack Operations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/grouping/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Grouping
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Contributing
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Contributing
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/development/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Development
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Testing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Troubleshooting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#defaults-at-a-glance" class="md-nav__link">
    <span class="md-ellipsis">
      
        Defaults at a glance
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quick-verification" class="md-nav__link">
    <span class="md-ellipsis">
      
        Quick verification
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#raw-jpeg-pairing" class="md-nav__link">
    <span class="md-ellipsis">
      
        RAW + JPEG Pairing
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RAW + JPEG Pairing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#canon-nikon-sony-same-filename-different-extension" class="md-nav__link">
    <span class="md-ellipsis">
      
        Canon / Nikon / Sony (same filename, different extension)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fujifilm-raf-jpeg" class="md-nav__link">
    <span class="md-ellipsis">
      
        Fujifilm RAF + JPEG
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#samsung-galaxy-jpg-dng" class="md-nav__link">
    <span class="md-ellipsis">
      
        Samsung Galaxy (JPG + DNG)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#apple-iphone-proraw-heic-dng" class="md-nav__link">
    <span class="md-ellipsis">
      
        Apple iPhone ProRAW (HEIC + DNG)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#google-pixel-photos" class="md-nav__link">
    <span class="md-ellipsis">
      
        Google Pixel Photos
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Google Pixel Photos">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pixel-raw-jpeg-standard" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pixel RAW + JPEG (standard)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pixel-motion-photos" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pixel Motion Photos
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pixel-10-pro-triple-grouping-30x-zoom" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pixel 10 Pro Triple Grouping (30x Zoom)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#google-photos-edited-versions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Google Photos Edited Versions
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rawjpeg-with-lightroom-numeric-edits" class="md-nav__link">
    <span class="md-ellipsis">
      
        RAW+JPEG with Lightroom Numeric Edits
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#photoshop-workflows" class="md-nav__link">
    <span class="md-ellipsis">
      
        Photoshop Workflows
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Photoshop Workflows">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#raw-jpeg-psd-photoshop-project-files" class="md-nav__link">
    <span class="md-ellipsis">
      
        RAW + JPEG + PSD (Photoshop Project Files)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#raw-jpeg-psd-with-final-export" class="md-nav__link">
    <span class="md-ellipsis">
      
        RAW + JPEG + PSD with Final Export
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#photoshop-with-versioned-exports" class="md-nav__link">
    <span class="md-ellipsis">
      
        Photoshop with Versioned Exports
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aperturelightroom-vault-with-photoshop-edits" class="md-nav__link">
    <span class="md-ellipsis">
      
        Aperture/Lightroom Vault with Photoshop Edits
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#burst-photos" class="md-nav__link">
    <span class="md-ellipsis">
      
        Burst Photos
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Burst Photos">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#camera-bursts-with-shared-timestamp" class="md-nav__link">
    <span class="md-ellipsis">
      
        Camera Bursts with Shared Timestamp
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sequential-burst-photos-with-common-prefix" class="md-nav__link">
    <span class="md-ellipsis">
      
        Sequential Burst Photos with Common Prefix
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#limitation-fully-sequential-filenames" class="md-nav__link">
    <span class="md-ellipsis">
      
        Limitation: Fully Sequential Filenames
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parent-selection-control" class="md-nav__link">
    <span class="md-ellipsis">
      
        Parent Selection Control
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Parent Selection Control">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#always-show-processed-files-on-top-lightroom-behavior" class="md-nav__link">
    <span class="md-ellipsis">
      
        Always Show Processed Files on Top (Lightroom Behavior)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#always-show-raw-on-top" class="md-nav__link">
    <span class="md-ellipsis">
      
        Always Show RAW on Top
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefer-edited-files-on-top" class="md-nav__link">
    <span class="md-ellipsis">
      
        Prefer Edited Files on Top
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mixed-camera-setups" class="md-nav__link">
    <span class="md-ellipsis">
      
        Mixed Camera Setups
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Mixed Camera Setups">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#multiple-cameras-with-different-naming" class="md-nav__link">
    <span class="md-ellipsis">
      
        Multiple Cameras with Different Naming
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#docker-compose-full-example" class="md-nav__link">
    <span class="md-ellipsis">
      
        Docker Compose Full Example
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="real-world-examples">Real-World Examples<a class="headerlink" href="#real-world-examples" title="Permanent link">&para;</a></h1>
<p>Common stacking scenarios and how to solve them with immich-auto-stack.</p>
<h2 id="defaults-at-a-glance">Defaults at a glance<a class="headerlink" href="#defaults-at-a-glance" title="Permanent link">&para;</a></h2>
<p>These examples assume the defaults unless overridden:</p>
<ul>
<li><strong>Criteria</strong>: <code>originalFileName</code> split on <code>["~", "."]</code> (index <code>0</code>) + <code>localDateTime</code> within <code>1000ms</code></li>
<li><strong>Parent filename promote</strong>: <code>cover,edit,crop,hdr,biggestNumber</code></li>
<li><strong>Parent ext promote</strong>: <code>.jpg,.png,.jpeg,.heic,.dng</code></li>
</ul>
<p><strong>Parent selection order</strong>:</p>
<ol>
<li>Regex <code>promote_index</code> (if present)</li>
<li>Parent filename promote (order matters)</li>
<li><code>biggestNumber</code> (only when in the promote list)</li>
<li>Parent ext promote (order matters)</li>
<li>Extension rank (<code>jpeg &gt; jpg &gt; png &gt; others</code>) when not explicitly promoted</li>
<li>Alphabetical (case-sensitive)</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Important</p>
<ul>
<li>Order matters in both promote lists.</li>
<li><code>biggestNumber</code> only works on numeric suffixes <strong>after delimiters found in your <code>originalFileName</code> split</strong>. If you want <code>-1</code> / <code>_2</code> to count, add <code>-</code> or <code>_</code> to <code>split.delimiters</code>.</li>
</ul>
</div>
<h2 id="quick-verification">Quick verification<a class="headerlink" href="#quick-verification" title="Permanent link">&para;</a></h2>
<p>Run in dry-run + debug to see grouping and parent selection in logs:</p>
<div class="highlight"><pre><span></span><code><span class="nv">LOG_LEVEL</span><span class="o">=</span>debug<span class="w"> </span>immich-stack<span class="w"> </span>--dry-run
</code></pre></div>
<p>All grouping/parent-selection scenarios below have matching tests in <code>pkg/stacker/examples_test.go</code>.</p>
<h2 id="raw-jpeg-pairing">RAW + JPEG Pairing<a class="headerlink" href="#raw-jpeg-pairing" title="Permanent link">&para;</a></h2>
<h3 id="canon-nikon-sony-same-filename-different-extension">Canon / Nikon / Sony (same filename, different extension)<a class="headerlink" href="#canon-nikon-sony-same-filename-different-extension" title="Permanent link">&para;</a></h3>
<p><strong>Problem:</strong> Your camera produces <code>IMG_1234.jpg</code> and <code>IMG_1234.CR2</code> (or <code>.NEF</code>, <code>.ARW</code>). You want them grouped as a single stack with the JPEG on top.</p>
<p><strong>Solution:</strong> The default configuration handles this out of the box. No custom criteria needed.</p>
<div class="highlight"><pre><span></span><code><span class="nv">API_KEY</span><span class="o">=</span>your_key
<span class="nv">API_URL</span><span class="o">=</span>http://immich-server:2283/api
</code></pre></div>
<p>The default criteria splits on <code>~</code> and <code>.</code> to extract the base filename (<code>IMG_1234</code>) and groups assets taken within 1 second of each other. The default <code>PARENT_EXT_PROMOTE=.jpg,.png,.jpeg,.heic,.dng</code> ensures common processed formats win over RAW.</p>
<h3 id="fujifilm-raf-jpeg">Fujifilm RAF + JPEG<a class="headerlink" href="#fujifilm-raf-jpeg" title="Permanent link">&para;</a></h3>
<p><strong>Problem:</strong> Your Fujifilm camera produces <code>DSCF1234.jpg</code> and <code>DSCF1234.RAF</code>. Same as above but with <code>.RAF</code> extension.</p>
<p><strong>Solution:</strong> Default configuration works. <code>.jpg</code> is promoted by default, so the JPEG will be the stack parent.</p>
<h3 id="samsung-galaxy-jpg-dng">Samsung Galaxy (JPG + DNG)<a class="headerlink" href="#samsung-galaxy-jpg-dng" title="Permanent link">&para;</a></h3>
<p><strong>Problem:</strong> Samsung phones produce <code>20240115_143022.jpg</code> and <code>20240115_143022.dng</code> when shooting RAW+JPEG.</p>
<p><strong>Solution:</strong> Default configuration works. Both <code>.jpg</code> and <code>.dng</code> are in the default extension promote list, with <code>.jpg</code> having higher priority.</p>
<h3 id="apple-iphone-proraw-heic-dng">Apple iPhone ProRAW (HEIC + DNG)<a class="headerlink" href="#apple-iphone-proraw-heic-dng" title="Permanent link">&para;</a></h3>
<p><strong>Problem:</strong> iPhones with ProRAW enabled produce <code>IMG_1234.HEIC</code> and <code>IMG_1234.DNG</code>. You want them stacked with the HEIC on top.</p>
<p><strong>Solution:</strong> Default configuration works. Both <code>.heic</code> and <code>.dng</code> are in the default extension promote list, with <code>.heic</code> having higher priority.</p>
<h2 id="google-pixel-photos">Google Pixel Photos<a class="headerlink" href="#google-pixel-photos" title="Permanent link">&para;</a></h2>
<h3 id="pixel-raw-jpeg-standard">Pixel RAW + JPEG (standard)<a class="headerlink" href="#pixel-raw-jpeg-standard" title="Permanent link">&para;</a></h3>
<p><strong>Problem:</strong> Pixel phones use a specific naming pattern:</p>
<ul>
<li><code>PXL_20260121_195958829.RAW-01.COVER.jpg</code></li>
<li><code>PXL_20260121_195958829.RAW-02.ORIGINAL.dng</code></li>
</ul>
<p>The default split on <code>["~", "."]</code> produces <code>PXL_20260121_195958829</code> from both files (index 0 after splitting on all delimiters). This works with default config out of the box.</p>
<p><strong>Solution:</strong> Default configuration works. For explicit control:</p>
<div class="highlight"><pre><span></span><code><span class="nv">CRITERIA</span><span class="o">=</span><span class="s1">&#39;[{&quot;key&quot;:&quot;originalFileName&quot;,&quot;split&quot;:{&quot;delimiters&quot;:[&quot;.&quot;],&quot;index&quot;:0}},{&quot;key&quot;:&quot;localDateTime&quot;,&quot;delta&quot;:{&quot;milliseconds&quot;:1000}}]&#39;</span>
<span class="nv">PARENT_EXT_PROMOTE</span><span class="o">=</span>.jpg,.png,.jpeg,.heic,.dng
</code></pre></div>
<h3 id="pixel-motion-photos">Pixel Motion Photos<a class="headerlink" href="#pixel-motion-photos" title="Permanent link">&para;</a></h3>
<p><strong>Problem:</strong> Pixel creates a Motion Photo variant alongside the regular photo:</p>
<ul>
<li><code>PXL_20240115_143022345.jpg</code></li>
<li><code>PXL_20240115_143022345.MP.jpg</code></li>
</ul>
<p>You want them stacked together.</p>
<p><strong>Solution:</strong> Default configuration groups them (both resolve to <code>PXL_20240115_143022345</code> after splitting on <code>["~", "."]</code>). To control which file is on top:</p>
<p>To put the <strong>Motion Photo on top</strong> (default behavior): no change needed. The case-sensitive alphabetical tiebreaker sorts <code>.MP.jpg</code> before <code>.jpg</code> (uppercase <code>M</code> &lt; lowercase <code>j</code>), so the Motion Photo is the parent by default.</p>
<p>To put the <strong>regular photo on top</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nv">PARENT_FILENAME_PROMOTE</span><span class="o">=</span>,mp,cover,edit,crop,hdr,biggestNumber
</code></pre></div>
<p>The leading empty string promotes files that do <strong>not</strong> contain <code>mp</code> (or any other keyword), making the plain <code>PXL_*.jpg</code> the parent.</p>
<h3 id="pixel-10-pro-triple-grouping-30x-zoom">Pixel 10 Pro Triple Grouping (30x Zoom)<a class="headerlink" href="#pixel-10-pro-triple-grouping-30x-zoom" title="Permanent link">&para;</a></h3>
<p><strong>Problem:</strong> The Pixel 10 Pro creates three files for high-zoom shots:</p>
<ul>
<li><code>PXL_20260120_120000000.jpg</code> (original JPEG)</li>
<li><code>PXL_20260120_120000000.dng</code> (RAW)</li>
<li><code>PXL_20260120_120000000.NIGHT.jpg</code> (AI-processed)</li>
</ul>
<p>All three should be in one stack with the original JPEG on top.</p>
<p><strong>Solution:</strong> Default configuration groups them (the split on <code>["~", "."]</code> extracts the same base filename from all three). However, the two <code>.jpg</code> files tie on extension promotion, and the case-sensitive alphabetical tiebreaker puts <code>.NIGHT.jpg</code> before <code>.jpg</code> (uppercase <code>N</code> &lt; lowercase <code>j</code>).</p>
<p>To ensure the original JPEG is on top, use negative matching:</p>
<div class="highlight"><pre><span></span><code><span class="nv">PARENT_FILENAME_PROMOTE</span><span class="o">=</span>,night,cover,edit,crop,hdr,biggestNumber
</code></pre></div>
<p>The leading empty string promotes files that do <strong>not</strong> contain <code>night</code> (or any other keyword), making the plain <code>.jpg</code> the parent.</p>
<h2 id="google-photos-edited-versions">Google Photos Edited Versions<a class="headerlink" href="#google-photos-edited-versions" title="Permanent link">&para;</a></h2>
<p><strong>Problem:</strong> Google Photos exports include edited copies alongside originals:</p>
<ul>
<li><code>vacation_sunset.jpg</code></li>
<li><code>vacation_sunset-edited.jpg</code></li>
</ul>
<p>You want them stacked together.</p>
<p><strong>Solution:</strong> Add <code>-</code> to the split delimiters so both files resolve to the same base name:</p>
<div class="highlight"><pre><span></span><code><span class="nv">CRITERIA</span><span class="o">=</span><span class="s1">&#39;[{&quot;key&quot;:&quot;originalFileName&quot;,&quot;split&quot;:{&quot;delimiters&quot;:[&quot;-&quot;,&quot;~&quot;,&quot;.&quot;],&quot;index&quot;:0}},{&quot;key&quot;:&quot;localDateTime&quot;,&quot;delta&quot;:{&quot;milliseconds&quot;:1000}}]&#39;</span>
<span class="nv">PARENT_FILENAME_PROMOTE</span><span class="o">=</span>edit,cover,crop,hdr,biggestNumber
</code></pre></div>
<p>The split on <code>["-", "~", "."]</code> extracts <code>vacation_sunset</code> from both files. <code>PARENT_FILENAME_PROMOTE</code> with <code>edit</code> first makes the edited version the parent since its filename contains "edited". To put the <strong>original on top</strong> instead, use negative matching:</p>
<div class="highlight"><pre><span></span><code><span class="nv">PARENT_FILENAME_PROMOTE</span><span class="o">=</span>,edit,cover,crop,hdr,biggestNumber
</code></pre></div>
<p>The leading empty string promotes files that do <strong>not</strong> contain <code>edit</code> (or any other keyword), making the plain <code>vacation_sunset.jpg</code> the parent. Simply removing <code>edit</code> from the promote list is not enough  the alphabetical tiebreaker would still pick <code>vacation_sunset-edited.jpg</code> because <code>-</code> sorts before <code>.</code>.</p>
<h2 id="rawjpeg-with-lightroom-numeric-edits">RAW+JPEG with Lightroom Numeric Edits<a class="headerlink" href="#rawjpeg-with-lightroom-numeric-edits" title="Permanent link">&para;</a></h2>
<p><strong>Problem:</strong> You shoot RAW+JPEG and use Lightroom to export edited versions with numeric suffixes. Your library contains:</p>
<ul>
<li><code>ABC001.ARW</code></li>
<li><code>ABC001.JPEG</code></li>
<li><code>ABC001-1.JPEG</code></li>
<li><code>ABC001-2.JPEG</code></li>
</ul>
<p>You want all four in one stack, with the latest edit (<code>ABC001-2.JPEG</code>) as the thumbnail.</p>
<p><strong>Solution:</strong> Add <code>-</code> to the split delimiters so all files resolve to the same base name <code>ABC001</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nv">CRITERIA</span><span class="o">=</span><span class="s1">&#39;[{&quot;key&quot;:&quot;originalFileName&quot;,&quot;split&quot;:{&quot;delimiters&quot;:[&quot;-&quot;,&quot;~&quot;,&quot;.&quot;],&quot;index&quot;:0}},{&quot;key&quot;:&quot;localDateTime&quot;,&quot;delta&quot;:{&quot;milliseconds&quot;:1000}}]&#39;</span>
<span class="nv">PARENT_EXT_PROMOTE</span><span class="o">=</span>.jpg,.png,.jpeg,.heic,.dng,.arw
</code></pre></div>
<p>The default <code>PARENT_FILENAME_PROMOTE</code> already includes <code>biggestNumber</code>, which picks <code>ABC001-2.JPEG</code> (highest numeric suffix) as the parent. <code>PARENT_EXT_PROMOTE</code> with processed formats first ensures a JPG/PNG wins over the RAW when no numeric edit exists.</p>
<p>This also works with the Pixel RAW naming pattern (<code>PXL_*.RAW-01.COVER.jpg</code> / <code>PXL_*.RAW-02.ORIGINAL.dng</code>) since the same split logic extracts the shared base. The default promote list includes <code>cover</code>, so the COVER JPEG can be selected as parent.</p>
<h2 id="photoshop-workflows">Photoshop Workflows<a class="headerlink" href="#photoshop-workflows" title="Permanent link">&para;</a></h2>
<h3 id="raw-jpeg-psd-photoshop-project-files">RAW + JPEG + PSD (Photoshop Project Files)<a class="headerlink" href="#raw-jpeg-psd-photoshop-project-files" title="Permanent link">&para;</a></h3>
<p><strong>Problem:</strong> You shoot RAW+JPEG and edit in Photoshop, keeping the <code>.psd</code> project file alongside exports. Your library contains:</p>
<ul>
<li><code>IMG_1234.CR2</code> (RAW)</li>
<li><code>IMG_1234.jpg</code> (camera JPEG)</li>
<li><code>IMG_1234.psd</code> (Photoshop project)</li>
</ul>
<p>You want all files grouped with the JPEG on top.</p>
<p><strong>Solution:</strong> Default configuration groups files with the same base filename. The <code>.psd</code> extension is listed after JPEG formats in the default extension promote list, so JPEG files become the stack thumbnail:</p>
<div class="highlight"><pre><span></span><code><span class="nv">API_KEY</span><span class="o">=</span>your_key
<span class="nv">API_URL</span><span class="o">=</span>http://immich-server:2283/api
</code></pre></div>
<h3 id="raw-jpeg-psd-with-final-export">RAW + JPEG + PSD with Final Export<a class="headerlink" href="#raw-jpeg-psd-with-final-export" title="Permanent link">&para;</a></h3>
<p><strong>Problem:</strong> You also export a final edited version alongside the source files:</p>
<ul>
<li><code>IMG_1234.CR2</code> (RAW)</li>
<li><code>IMG_1234.jpg</code> (camera JPEG)</li>
<li><code>IMG_1234.psd</code> (Photoshop project)</li>
<li><code>IMG_1234-final.jpg</code> (exported edit)</li>
</ul>
<p>You want all files grouped with the final export on top.</p>
<p><strong>Solution:</strong> Add <code>-</code> to the split delimiters so <code>IMG_1234-final.jpg</code> groups with the others:</p>
<div class="highlight"><pre><span></span><code><span class="nv">CRITERIA</span><span class="o">=</span><span class="s1">&#39;[{&quot;key&quot;:&quot;originalFileName&quot;,&quot;split&quot;:{&quot;delimiters&quot;:[&quot;-&quot;,&quot;~&quot;,&quot;.&quot;],&quot;index&quot;:0}},{&quot;key&quot;:&quot;localDateTime&quot;,&quot;delta&quot;:{&quot;milliseconds&quot;:1000}}]&#39;</span>
<span class="nv">PARENT_FILENAME_PROMOTE</span><span class="o">=</span>final,edit,cover,crop,hdr,biggestNumber
<span class="nv">PARENT_EXT_PROMOTE</span><span class="o">=</span>.jpg,.png,.jpeg,.heic,.psd,.dng,.cr2
</code></pre></div>
<p>The split on <code>["-", "~", "."]</code> extracts <code>IMG_1234</code> from all files. The <code>final</code> keyword promotes <code>IMG_1234-final.jpg</code> as parent.</p>
<h3 id="photoshop-with-versioned-exports">Photoshop with Versioned Exports<a class="headerlink" href="#photoshop-with-versioned-exports" title="Permanent link">&para;</a></h3>
<p><strong>Problem:</strong> You use Photoshop's "Save As" to create multiple export versions:</p>
<ul>
<li><code>portrait.psd</code> (project file)</li>
<li><code>portrait_1.jpg</code> (first export)</li>
<li><code>portrait_2.jpg</code> (second export)</li>
<li><code>portrait_final.jpg</code> (final version)</li>
</ul>
<p>You want them stacked with the final version on top.</p>
<p><strong>Solution:</strong> Add <code>_</code> to the split delimiters so all files resolve to the same base name:</p>
<div class="highlight"><pre><span></span><code><span class="nv">CRITERIA</span><span class="o">=</span><span class="s1">&#39;[{&quot;key&quot;:&quot;originalFileName&quot;,&quot;split&quot;:{&quot;delimiters&quot;:[&quot;_&quot;,&quot;~&quot;,&quot;.&quot;],&quot;index&quot;:0}},{&quot;key&quot;:&quot;localDateTime&quot;,&quot;delta&quot;:{&quot;milliseconds&quot;:86400000}}]&#39;</span>
<span class="nv">PARENT_FILENAME_PROMOTE</span><span class="o">=</span>final,biggestNumber
<span class="nv">PARENT_EXT_PROMOTE</span><span class="o">=</span>.jpg,.png,.jpeg,.psd
</code></pre></div>
<p>The split on <code>["_", "~", "."]</code> extracts <code>portrait</code> from all files. <code>final</code> in the promote list ensures <code>portrait_final.jpg</code> is the parent. The <code>biggestNumber</code> fallback handles versioned files (<code>_2</code> &gt; <code>_1</code>) when no <code>final</code> file exists. The large time delta (24 hours) accommodates files created across editing sessions.</p>
<div class="admonition warning">
<p class="admonition-title"><code>biggestNumber</code> limitation</p>
<p><code>biggestNumber</code> requires pure numeric suffixes (e.g., <code>_1</code>, <code>_2</code>). Files named <code>_v1</code>, <code>_v2</code> will fall back to alphabetical ordering.</p>
</div>
<p>To put the <strong>PSD on top</strong> instead (useful if you primarily work in Photoshop):</p>
<div class="highlight"><pre><span></span><code><span class="nv">PARENT_EXT_PROMOTE</span><span class="o">=</span>.psd,.jpg,.png,.jpeg
</code></pre></div>
<h3 id="aperturelightroom-vault-with-photoshop-edits">Aperture/Lightroom Vault with Photoshop Edits<a class="headerlink" href="#aperturelightroom-vault-with-photoshop-edits" title="Permanent link">&para;</a></h3>
<p><strong>Problem:</strong> You migrated from Aperture or Lightroom and have a mix of RAW, JPEG, and Photoshop files with various naming conventions:</p>
<ul>
<li><code>IMG_1234.CR2</code> (original RAW)</li>
<li><code>IMG_1234.jpg</code> (original JPEG)</li>
<li><code>IMG_1234-Edit.psd</code> (Photoshop edit)</li>
<li><code>IMG_1234-Edit.jpg</code> (exported from Photoshop)</li>
</ul>
<p>You want all four grouped with the exported edit on top.</p>
<p><strong>Solution:</strong> Add <code>-</code> to the split delimiters:</p>
<div class="highlight"><pre><span></span><code><span class="nv">CRITERIA</span><span class="o">=</span><span class="s1">&#39;[{&quot;key&quot;:&quot;originalFileName&quot;,&quot;split&quot;:{&quot;delimiters&quot;:[&quot;-&quot;,&quot;~&quot;,&quot;.&quot;],&quot;index&quot;:0}},{&quot;key&quot;:&quot;localDateTime&quot;,&quot;delta&quot;:{&quot;milliseconds&quot;:86400000}}]&#39;</span>
<span class="nv">PARENT_FILENAME_PROMOTE</span><span class="o">=</span>edit,cover,crop,hdr,biggestNumber
<span class="nv">PARENT_EXT_PROMOTE</span><span class="o">=</span>.jpg,.png,.jpeg,.heic,.psd,.dng,.cr2
</code></pre></div>
<p>This puts <code>IMG_1234-Edit.jpg</code> on top (contains "edit" + has <code>.jpg</code> extension priority over <code>.psd</code>).</p>
<h2 id="burst-photos">Burst Photos<a class="headerlink" href="#burst-photos" title="Permanent link">&para;</a></h2>
<h3 id="camera-bursts-with-shared-timestamp">Camera Bursts with Shared Timestamp<a class="headerlink" href="#camera-bursts-with-shared-timestamp" title="Permanent link">&para;</a></h3>
<p><strong>Problem:</strong> Some cameras embed a shared timestamp in burst filenames:</p>
<ul>
<li><code>DSCPDC_0000_BURST20180828114700954.JPG</code></li>
<li><code>DSCPDC_0001_BURST20180828114700954.JPG</code></li>
<li><code>DSCPDC_0002_BURST20180828114700954.JPG</code></li>
<li><code>DSCPDC_0003_BURST20180828114700954_COVER.JPG</code></li>
</ul>
<p>You want them grouped into one stack with the cover shot on top.</p>
<p><strong>Solution:</strong> Use a regex to extract the shared BURST timestamp for grouping, and <code>sequence</code> for ordering:</p>
<div class="highlight"><pre><span></span><code><span class="nv">CRITERIA</span><span class="o">=</span><span class="s1">&#39;[{&quot;key&quot;:&quot;originalFileName&quot;,&quot;regex&quot;:{&quot;key&quot;:&quot;BURST(\\d+)&quot;,&quot;index&quot;:1}},{&quot;key&quot;:&quot;localDateTime&quot;,&quot;delta&quot;:{&quot;milliseconds&quot;:1000}}]&#39;</span>
<span class="nv">PARENT_FILENAME_PROMOTE</span><span class="o">=</span>cover,sequence
</code></pre></div>
<p>The regex extracts <code>20180828114700954</code> from all four files, grouping them. The <code>cover</code> keyword promotes the <code>_COVER</code> file as parent. The <code>sequence</code> keyword orders the rest numerically.</p>
<h3 id="sequential-burst-photos-with-common-prefix">Sequential Burst Photos with Common Prefix<a class="headerlink" href="#sequential-burst-photos-with-common-prefix" title="Permanent link">&para;</a></h3>
<p><strong>Problem:</strong> Your camera names bursts as <code>photo_0001.jpg</code>, <code>photo_0002.jpg</code>, <code>photo_0003.jpg</code>. They share a common prefix but have different sequence numbers.</p>
<p><strong>Solution:</strong> Use a regex to extract the common prefix for grouping, then <code>sequence</code> to control parent order:</p>
<div class="highlight"><pre><span></span><code><span class="nv">CRITERIA</span><span class="o">=</span><span class="s1">&#39;[{&quot;key&quot;:&quot;originalFileName&quot;,&quot;regex&quot;:{&quot;key&quot;:&quot;^(.+?)_\\d+\\.&quot;,&quot;index&quot;:1}},{&quot;key&quot;:&quot;localDateTime&quot;,&quot;delta&quot;:{&quot;milliseconds&quot;:3000}}]&#39;</span>
<span class="nv">PARENT_FILENAME_PROMOTE</span><span class="o">=</span>sequence,cover,edit,crop,hdr
</code></pre></div>
<p>The regex extracts <code>photo</code> from all three files, grouping them together. The <code>sequence</code> keyword sorts the stack by the numeric portion, making the first in sequence the parent.</p>
<div class="admonition info">
<p class="admonition-title">Important</p>
<p>The <code>sequence</code> keyword controls <strong>parent selection order</strong> within an already-grouped stack. It does not affect grouping itself. The regex criterion is what makes the files group together.</p>
</div>
<h3 id="limitation-fully-sequential-filenames">Limitation: Fully Sequential Filenames<a class="headerlink" href="#limitation-fully-sequential-filenames" title="Permanent link">&para;</a></h3>
<p>Photos with completely different base filenames (e.g., <code>IMG_1234.jpg</code>, <code>IMG_1235.jpg</code>, <code>IMG_1236.jpg</code>) cannot be reliably grouped by filename since no shared portion can be extracted. Apple iPhone bursts fall into this category as they rely on EXIF BurstUUID metadata, which is not available through the Immich API.</p>
<h2 id="parent-selection-control">Parent Selection Control<a class="headerlink" href="#parent-selection-control" title="Permanent link">&para;</a></h2>
<h3 id="always-show-processed-files-on-top-lightroom-behavior">Always Show Processed Files on Top (Lightroom Behavior)<a class="headerlink" href="#always-show-processed-files-on-top-lightroom-behavior" title="Permanent link">&para;</a></h3>
<p><strong>Problem:</strong> You want processed files (JPEG, PNG, HEIC) always displayed as the stack representative, with RAW files accessible but hidden behind them.</p>
<p><strong>Solution:</strong></p>
<div class="highlight"><pre><span></span><code><span class="nv">PARENT_EXT_PROMOTE</span><span class="o">=</span>.jpg,.png,.jpeg,.heic,.dng,.cr2,.cr3,.nef,.arw,.raf,.orf,.rw2
</code></pre></div>
<p>List processed formats first. RAW formats at the end means they'll never be chosen as parent when a processed file exists.</p>
<h3 id="always-show-raw-on-top">Always Show RAW on Top<a class="headerlink" href="#always-show-raw-on-top" title="Permanent link">&para;</a></h3>
<p><strong>Problem:</strong> You primarily work with RAW files and want them as the stack representative.</p>
<p><strong>Solution:</strong></p>
<div class="highlight"><pre><span></span><code><span class="nv">PARENT_EXT_PROMOTE</span><span class="o">=</span>.dng,.cr2,.cr3,.nef,.arw,.raf,.orf,.rw2,.jpg,.png,.jpeg
</code></pre></div>
<h3 id="prefer-edited-files-on-top">Prefer Edited Files on Top<a class="headerlink" href="#prefer-edited-files-on-top" title="Permanent link">&para;</a></h3>
<p><strong>Problem:</strong> You have edited versions alongside originals and want the edit to always be the stack parent.</p>
<p><strong>Solution:</strong></p>
<div class="highlight"><pre><span></span><code><span class="nv">PARENT_FILENAME_PROMOTE</span><span class="o">=</span>final,edit,crop,hdr,cover,biggestNumber
</code></pre></div>
<p>Files containing "final" get highest priority, then "edit", etc.</p>
<h2 id="mixed-camera-setups">Mixed Camera Setups<a class="headerlink" href="#mixed-camera-setups" title="Permanent link">&para;</a></h2>
<h3 id="multiple-cameras-with-different-naming">Multiple Cameras with Different Naming<a class="headerlink" href="#multiple-cameras-with-different-naming" title="Permanent link">&para;</a></h3>
<p><strong>Problem:</strong> You shoot with both a Pixel phone and a Canon DSLR. Pixel files are <code>PXL_*.jpg</code> + <code>PXL_*.dng</code>, Canon files are <code>IMG_*.JPG</code> + <code>IMG_*.CR2</code>. You want both sets to stack correctly.</p>
<p><strong>Solution:</strong> Default configuration handles both since it groups by filename before extension + timestamp. Both naming patterns work with the default <code>split</code> on <code>"."</code>.</p>
<p>For explicit camera-aware grouping with an OR expression:</p>
<div class="highlight"><pre><span></span><code><span class="nv">CRITERIA</span><span class="o">=</span><span class="s1">&#39;{</span>
<span class="s1">    &quot;mode&quot;: &quot;advanced&quot;,</span>
<span class="s1">    &quot;expression&quot;: {</span>
<span class="s1">        &quot;operator&quot;: &quot;AND&quot;,</span>
<span class="s1">        &quot;children&quot;: [</span>
<span class="s1">            {</span>
<span class="s1">                &quot;operator&quot;: &quot;OR&quot;,</span>
<span class="s1">                &quot;children&quot;: [</span>
<span class="s1">                    {</span>
<span class="s1">                        &quot;criteria&quot;: {</span>
<span class="s1">                            &quot;key&quot;: &quot;originalFileName&quot;,</span>
<span class="s1">                            &quot;regex&quot;: {&quot;key&quot;: &quot;^(PXL_\\d+_\\d+)&quot;, &quot;index&quot;: 1}</span>
<span class="s1">                        }</span>
<span class="s1">                    },</span>
<span class="s1">                    {</span>
<span class="s1">                        &quot;criteria&quot;: {</span>
<span class="s1">                            &quot;key&quot;: &quot;originalFileName&quot;,</span>
<span class="s1">                            &quot;regex&quot;: {&quot;key&quot;: &quot;^(IMG_\\d+)&quot;, &quot;index&quot;: 1}</span>
<span class="s1">                        }</span>
<span class="s1">                    },</span>
<span class="s1">                    {</span>
<span class="s1">                        &quot;criteria&quot;: {</span>
<span class="s1">                            &quot;key&quot;: &quot;originalFileName&quot;,</span>
<span class="s1">                            &quot;split&quot;: {&quot;delimiters&quot;: [&quot;~&quot;, &quot;.&quot;], &quot;index&quot;: 0}</span>
<span class="s1">                        }</span>
<span class="s1">                    }</span>
<span class="s1">                ]</span>
<span class="s1">            },</span>
<span class="s1">            {</span>
<span class="s1">                &quot;criteria&quot;: {</span>
<span class="s1">                    &quot;key&quot;: &quot;localDateTime&quot;,</span>
<span class="s1">                    &quot;delta&quot;: {&quot;milliseconds&quot;: 1000}</span>
<span class="s1">                }</span>
<span class="s1">            }</span>
<span class="s1">        ]</span>
<span class="s1">    }</span>
<span class="s1">}&#39;</span>
</code></pre></div>
<p>The OR expression tries Pixel naming first, then Canon, then falls back to generic split. The AND with <code>localDateTime</code> ensures time proximity.</p>
<h2 id="docker-compose-full-example">Docker Compose Full Example<a class="headerlink" href="#docker-compose-full-example" title="Permanent link">&para;</a></h2>
<p>A complete <code>docker-compose.yml</code> for Pixel RAW+JPEG with edited file promotion:</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">immich-stack</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">majorfi/immich-stack:latest</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">API_KEY=your_immich_api_key</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">API_URL=http://immich-server:2283/api</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RUN_MODE=cron</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CRON_INTERVAL=3600</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PARENT_EXT_PROMOTE=.jpg,.png,.jpeg,.heic,.dng</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PARENT_FILENAME_PROMOTE=cover,edit,crop,hdr,biggestNumber</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">LOG_LEVEL=info</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unless-stopped</span>
</code></pre></div>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="January 29, 2026 18:43:46 UTC">January 29, 2026</span>
  </span>

    
    
    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.expand", "search.highlight", "search.share", "search.suggest"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>